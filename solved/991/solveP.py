import gmpy2
from Crypto.Util.number import long_to_bytes

# 문제에서 주어진 값
e = 3
N = 19884222029764619856532189569404376250563156767748276904201712582929458763811990805976375288644992872765358677421386172580952512357387868439272848350518674967735890302784777077355491775124178999369281334775117061754279507528522292535789143685913748561525380751289249914737184504972215629334114646454894554760809876240317272935278305302423881582721553631645851649901256376860518455733600691272902950269933309595563731697224609338148608622094118254059701197587558419741525301160892799388260286158885648133441824311292534954776987267816742727389884836879125016847491639196982130616547428396435782301087608123644970478979
c = 3021707745705914717651932099169168208235712676167718078692122933691485374057028911998943345172521733411101314628815022659490803442844618954413140489295354154403280343517306999272476905608959365312022675566922361996146509039679143309999884410600120110005758740177796709292326142700733840281371633190982454094038156388959584702890861083812792607675801620840354424270070201264834985158396573621234143427485269282752355459780369697551980040208076682409974507477566497326620351766287448951298187046661445171969319487511046743211743696953584137813659320328582183904349337110327298045522698431499403515141426896689036371302

print("Starting brute-force for k...")

# k의 범위를 추정하여 반복 (0부터 시작)
k = 0
while True:
    # m^3 = c + k * N 식을 이용
    target = c + k * N
    
    # target의 세제곱근이 정수로 떨어지는지 확인
    m, is_exact = gmpy2.iroot(target, 3)
    
    if is_exact:
        print(f"Found k: {k}")
        print("Decoded Message (Integer):", m)
        try:
            flag = long_to_bytes(m)
            print("Flag:", flag.decode())
        except:
            print("Could not decode bytes (check format)")
        break
    
    k += 1
    
    # 무한 루프 방지용 (안전 장치)
    if k > 200000:
        print("k limit exceeded. Something is wrong.")
        break