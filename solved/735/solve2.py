import gmpy2
from Crypto.Util.number import long_to_bytes

# [USER ì…ë ¥]
pub = [783025449377672626193280734956315313350296296439381589045840917921834679667023611739245691258674, 1437984698008464902715206814643452148739137204708990107739687826928824352670597936040584647360181, 694081995640454577355814272342925794773811046864326472872865164146621881611691610505034958649013, 479417302214652474589196460663166906298618609447547244150507160129821458060967064628268695455400, 305805969436029599041064391642268610534520471523912769326350499156984167837934896492886445012286, 547715450475818747723538718252008849278127250552908087169438196270858381806969392520337138807041, 144916210927941594236315518057283974476812466763715951345198424580846921389646584170128544206243, 898979329819440418065397134703936396383104468409527392200247452650051210710981354099899090222027, 395421364931326933214131794341575380466548357122687448952995472091415923507084691771020643724299, 473149304996722850039120025189757557184907610243430925245986973516615721484849890350930198556011, 109581730578957310682138451334138991078642655774760161738444445200480784914734010211510883451270, 1169733167959830370043944412744774196421997003788894842677989475491557992263522514160832824494060, 1551635541786791863675154131043947994820326084835138303924684769278453280788376296283479027937105, 1107043739923513626923532013152603938705637155376889307472737585733540519805790848068974843293700, 634368827793262810470683637220899666397211122784217364256709850397944769926741900593846910908199, 1318808331074444738738332870917089378405914338256069549530308768511013614956877235591296369852426, 645111614182408244144288592804162666213141001372146936274966510948653666491668280855318681877627, 1578555208791629036932556917629791092476608842758702493225387405056636105260905019272574315392120, 300199619489155629114548755030860479126598098155168521113659985811322669515534707423485766985308, 1012123282476893731446419561729876044436714013319288733836659367363939435907519835073731435211549, 1111776301377210185726833546991843973193098557112676286057223115097251680438915628789225554375070, 223994180730781947583438610836576684326384787133074998541516941572150013166076566527654356025426, 1556121023562290915622832493700048030147501144544584246205529972393007143671591546241853035521918, 509526733393649959384825869917303306485587602458933276024294205273664915707778307854355371314452, 1472203565278834850122689314670388699534890933772358328567078155414656065528554901436459871062776, 965583640920239211854684250698031100005771990663893007283565054034164719035645368494574385661630, 1221428719328834845585760295828575371454802023873267402465522253153702772985117641468927476148637, 1165164913591751493996722848069533732251785435417409150704954354547615587245610992599460167066302, 720500845504576194188941956635579491658715475952761932401295119200296994609603020803103816084128, 825924575571942848031817503122231850852924706124628718949401347798051488633493788196482062833715, 106703555644119473551185413700606764852445961374721527263160430107835769567205874155849165083534, 105596875813885486462376083477395214995163137060410651473623614260967243756881615176915342723488, 1537687363632028144480546344168780245765196120667579249935682104068219552783164981768828120696346, 1029942333900941369581237643568664568552763660450572407934201936591086785533738101864721348639304, 1499786664255314893838783668554088714750415018483637532115613502030184488235113609031891423689176, 265395733645343144485398509354790347347294820891374016612729249539519153437414363090181080580965, 474439757328201003010317828414793767765386138355187338751337666929078761608437988176031339407180, 200040036266438169370479564837368208244761853498200513036631492667479915266779365666366970475111, 514909917453713419512858925697026857157772665150483676731421760802462581111422486152662659610224, 735136558755016853521402544658548719540976724771710730352211954467099565092657474198791653548475, 500117462349513051317912564693512117053523983627158683999790077180569534262270659398299499930700, 808251234041526344206183781061510092133144110940576645486346574936989466642304374271043392468019, 1606310773955001214936708049142500727379918673912932902403597177809188609274547561824897891301392, 768833609164765244685431688537282774070210379505538913945804820318724898747832237045865766517697, 753190746039944636058378946858257045980855935956673651932461542739377320165269266260127507927454, 574386334236671425602514229713589087839897024115966165674548973737085566417450624800640301107197, 1044899575313387652052422728829273610051315668866845215936863071015218355361962939896739758490081, 1001693253111593444655691273347892617787553011885045710699608727292772213355508176777407289359311, 1270984207212420757418880978875774049163785071990365947559422993339158882602267551935222793422382, 1380739011848572421315737721594813129980616820865895053124447240516017237892536606349066966665328, 184323966667682954598387714778767974139397559587350859854678432311631018133890359739171948374677, 647421932198377170410258602564240958827843454049405804222536356088023186698290666710847882275268, 555894642607910737067865676220843225696703950346090327880028266335084026756046312448001889547277, 383854535638303734805096988161818317828376863259893209048214132310280867584937606932946760492083, 706681131524101778227687306369376589500982243108528045538794332954031848172930934270382356505438, 834146111248241082034432718281343179970232714830867340660011932018359774053553762887871646355904, 1602797380009616627355527416006993140878140856074595925424262712081559045094749678718250777785075, 65284711691197628766959351208934082310257332147331598276597532983781988466651533808294219147812, 777103659626975054606028395282838445714564914088625697811977834681585725715470295512179444383220, 662730992069417322728192329428184924503214584862118954003269515473974708310290720645749942958204, 14207950131549464964450051199865453078200753081118806209281103053521821722019907305511362504136, 401275235563645111389540417557019452605549413801362991837123743531575772121775116110833119469844, 1142136184440619779086530442769808360456959152658368758019126849275170069838269600484992491014010, 1278926481522157264312976341115050283419646623259371469134914682849471236412649966909136439155360, 1406080003211536907411075149045267681705246800847023332669855036019101978462829076682160523443379, 137853235220662080824785609127317276475394963109486464536657878328766485913114041895847253047089, 938884596184970521769692669141268792673019267529239512000573988851977950657429510827740635869251, 734034906829604234950096867721178669110349993470143793841039477458985102083181104369042072894795, 822597441866552517631223456499923464527416395699553159076957598882185806001990202995190659310529, 70561646376719078544446892254112867181087535921169004300989167869332874705186986833291697819338, 1163668734592017928168011484401528932622006121972674391943420655083466205394713986543347587218795, 1128933382120135339405302432115413487784735465851102017050105083761345583713892641422955530715049, 949088171686749752773879951344625533689724986574110693687506391756789134957131225205136769382468, 171539847955638371395035873903267508511062178805132740545223317958498612151126644276086205139114, 554038453846626042140530015819161729487079556406497477407285592508228906419108853421720553707318, 412994459969450853045596287637760285368243372462653710915604099898368659159959671651892247568876, 920711488522823515584629402133646152352485577216047585841640001706551811217758935930574927704027, 1394493562773510210735931919738723769563994199021393779172589058402406046087267165881077933127789, 943502939957110430850856219548341996059193110726309071303534556335583308592072946455829374092779, 1238422491824823406821343137320730940548246345884111416631801389518224201926094505928388768666587, 271079671036911377449137555738072177648348835403294182714753519152139433375937372017611010950787, 55414118872207220659025659540070209007416339087632787816414943275324256181926320557373040783437, 297908281628189764087697874776790868890229295864809231100805129423677499110006167769518747364046, 96507604038549854726924732723221813494051856125704015126209845101718285770343474678929527303786, 1272433308319768408171058822250342356602226552467345996284122684210843077551473412112988104101064, 425134224093621958597505616787883289037855171903937010196094292680685931072536860191929162259549, 912204297954651474717735889852469147482312547527949951180564911774424382287654102318544159514134, 1046067205728010947518834018925807780144110354454881367495696694319581070700792185456392263457446, 1124768126047000055990593533558798980381415906363029975088468129466697098582285620888928387254069, 580207304425486332404387131390824078770238081640687052797059821382028901187539654023288292607612, 809168266782848971083782853084600815947038778110279363617543848291323390417791947791279935866122, 1088323986010997076960962381013491094876471593310114078487758527516058603283362789789923283186344, 1493062410947428459654034890730639778303447679512667064383137297656754145439881336734598625291025, 712686644463010867023649489298280893051387087970307357775437934309090794849326141241662125544769, 1149627956815976375296423042197629110091520465780886274209718495023680440040459907935378750997118, 855467211129789566253193883934722263071049655811643034811639933726587533220873836978641249576613, 1350213564245916358421950709073769028989886516413418191724625008452758691656462452343965832649279, 376727541214134999214624887460961084426098125687694432763063688383240364714953921468406473931208, 1129688263196187842066832162125452369282625822529274588663889740213047046221478298452128750237214, 543950264691233546980145373828299768608581939650078723122838348204706930225130019797041891776960, 403959935136207106680067169550136800128634798538577678167113135879326573931630557055964091632175, 594092217400868985907564843907669095718240461908417373505088644945997493622987900991771743730479, 1238864960734083525738287616240273315217675980042900273400773614489009726851228488274270509018431, 1341176696965253519209165224936370003584616922806709757867097322093242471044961767073221289692806, 913994466476757025065859594560929336626753083378156692811520305236710049524220150122286359158451, 512246004124982546338282611025269831355060495709304572099170203985873042324641783725398806819833, 407430591048038909528569205461399838536053260745984021515588624118862298430119204784191894070435, 1073760069083576854796723147129505694796485117832647866492827113876848567276331383430979281242855, 495963459332899790241627915170318273402190919956540195800245804048742936891941864510989536957083, 1431945378728554918644358065443035518484572194179806684251044130296058678996734655649578213405943, 544288205839167397603046981521508114760092051340764824384848627266116846629005755296243439639225, 1478123138017424035412991046922156280392068064691984187622694855992838873462264729930205941085565, 507989008284140030835610888174966906450817961134214653328221950877723011839226496539453286779682, 666219981477633306963283527116977276439105498360047872422963446151179995338810971329009142639989, 958598311691048563782436921016174919314485977451655246232309487825124811333374162812551720547415, 396361976891798690853832110514025102505883016165218574302481043212282197302486853425989948025072, 1143765973365568549416587882411045770793231304484393942325103555694704679652046628650246281442598, 1358813068319361965536568635355692253375834928657627988057030148742058421205983085496688978001815, 603035757739768959667363698744996980741331434693602190561224192534588771407445456733208333724277, 735617040136427121876647763730140819797399333188591985623052283036703536381822816297083699908252, 1349303917070252648072810201065602921832575126746307999309733731942076081599188360117865646298169, 525143300179953308064394366283014540134005779665765938316853274531346145527952283750238452005165, 1256034401663286840106826549391211628752451165028733134676928423953543006005355909864370433208418, 1347226978823177872381110919088454197263700218837778071459456203020838694158332076296819035290200, 227617667435678757990496618989362600180957758154927911794832784654203634001103586415953764461180, 762935343991112213911933354276036522075877370354534674803915335388655684040251200422208336612967, 1342941130727467602721201960575752542454046223969591320109531709249964799064002502922531037755220, 1117509014366772479048202678430653181376716731279238015882054882109571896067155046345777847314363, 1021197729857960048046566334626820657011532706800477078597145294475753693686368046432633415002744, 1149905471153607735573744133591820908356692885544592328315841508732344989405857896751593029472536, 397505963003619670137218619352286157979932627039759360533477185204371479371427610240676108274966, 1294683051560412051971628770136792016255868060862317470719241773910908197517002293879940781464279, 845669288085448931753278477479383943572474171470199546072099758722059674107609813537980257383023, 857717214780801385033488869282514965447849930407415711863317754179270691164305534165174229731879, 324853908762197209728838889929068856557760984865139192599193340542419364119540643726632869691117, 596306779580608638178794064295517047738648476903937672278543784254278170403127952939040691528232, 821236141014007282398922422098465054592686149496982374103255873043712194368781398543006176227716, 1488964637743258185566028793137676781414738687999581099749681016407825129602319044194642213529611, 1519670359118791755497953875251452078739518608832770573279934495702838016429952367164957854885055, 1333298546832264936970577060447134756097383195353451554823341091435280505697587588359390546739099, 1100325188513097081882909933050064752404862390336177622778195242116781525223443981606099367167313, 479720036976944879792595843895109344431976818612829263058457748372177928575189086898792626667443, 1235712305319658734067866118603622698661674031131535120597857302100029049785235566351621346622381, 244468856188240786045423648673856482724074435969420529333013322687676490622259791489770741120854, 1105623205000487022370971869250226089805398334698199032257207156543306602406872486901782137413711, 45440427721059278353673761396340208213591410383468108544673495719806930617301202464885739533760, 1581175869473868938298670136448601587251927939766738836837177082107745242898938229979080264614441, 799182086108350030607954354932451087266962791333997841638090268860838349064761210308276151303846, 956793541681099624000828888680451697658851886023895656725134246902848651414329604014088341644982, 1069964787803441961321914230619950021493964053705414093436145701354630145609306529256424567774437, 344526163236332231100080318344273215627722184842556148557273184143022625105382515067659339089303, 798363648310027462467170348776685452459451725797651908155820515301049872219270926674408484568890, 566524983238995316964775268103121722293796875312428601260596596038860400416223350320642459894002, 991342237586117680563950890080752489622030356401466118521185227853570908752024174606163809681164, 1088857662267689396321973973049294186772246572019675797293752627183561015225578729590945040954665, 359160569912487349580146333865717390851587510738879771935757559603072743446118839978420602738277, 923632596232507291979133653626106078174956651600498378483774580969693066251476129166200265776256, 1052423731009860785656789752899324494852991758748286999658625517332457016568909994702840525311922, 908307893410516699896549737852359810151291348470260334938691962538267659160108555733832567804181, 1034873718930374981786986913138051120770899999187564387588029130641486314900538545921870302810493, 28856783291998160828414042468170455785997454112432508135829873118194878143443160748507663505046, 146977858968145689247344871229266664571933929941203870422967332341767469877324377816013637831237, 659600658030511989860617731811174662272509319564413384705896193211567065758253341812223915622511, 986114132155244116816436243417207578678174276981820835752765317936299403390483959127727034880945, 1485748043733537360934435370603219648198834495687135299983919536748333417045393175968638568330309, 1037889973870447936602285747615724802803180772351367286275015714420690953092802658370804093192038, 1478191822645412238431387277326014605538139622086434209652941323411992724238558044498809633288288, 1093868182620968718776781452027219771649674146642296193102730638704259038444922223012335746969975, 1260205981994456435506745756348165777591531304611807671920207127660898955884354215885958085638414, 654423565064976197647722166291427276339480452200369418265196572313790903026548887290877179716455, 748219137688868228735764545933211121904794225505763219940942242474846032846397734180201031983123, 546597782820687818875169990515282140808304136431090971133357631971241770167094186507927783417579, 537003681015995449478446445934497872404993513668358164368086840334870818203007178567400881545662, 115147442348014396701057527306261073021586493585844220346478739954799342599947199529468392229058, 307407962652798791204401011001891047617389506654676501809009935009081600058139575060849441757416, 385464958930988527307228538280047630714928002582536773418958347209733506772504549764296138708254, 577192450659479839539420324936219404791855082954513414371230018836304437797402224723991909626116, 339180714787568278819265533179007263484282582392322923027002483846815905198572229093759111917223, 680515947157536990610397722386458481030768494981960820919523021751105726854150542853543925388414, 502770565301192884300067706858967037922245803275815061653019337588033790671694056370892020271676, 1186180505813622258302146496204988966015747836086050296710791585740972110323940323796221121010538, 1394983792082761974053686635165252673085681844391600029537895744659597762772077279685221300398110, 1022721863285384201050970629337535764687491527048331396863637009250986640197409464474579301705541, 90373998736090037865328332451594063772666365506536089336528250607632006540198358694191958435091, 536760617639243096467626345092971799083619951189313973637774962090001811925566354816902598649954, 1110548927120727630635475953560076263377058482634695194497700867919150663855603954103054691448987, 516941850872717905602432868468585465220875819407819259318513037329487917093208995880205365903115, 703477219583002632128797235620184457149549440997924419174854626447301237690636749192964223526080, 1108341312472019417504742858967224981654558560328694977270603955635979445367747764424176497809409, 427393185089936168348861671577748051973124434969482104325682767523513712378920710922514357090946, 1002963984380409851406665021975813295309965691254921158237142032829961708150282915340249055974824, 924101850625700314218525696844136814307505923811337188826964141943407568503511342386976425478330, 746203224111840821380789216868618251950346986792290200456390135033593761532155583589442617813042, 1130923047625495007416813069691075099734850360769034229940843204561843239098893417662468895106893, 1061713399541519135200725697899963824122618531992302251041241240197423826086558285389490209878521, 1375792117338121812978141080533926361977683815061922062646714803396494913399475118351926590229418, 298928483889870470979136669275195344110403756387602909058314730188992725230114204569808725664449, 771621653610601685892569525284822451247958045978775262655542089777680407868934133044404689977452, 886883592455527497092805598094103044090403521908507945376805800731465888969789007091085736416727, 753012612299869696865502965756593821176845127953181565428964781744925795084644851079096049148858, 1033603773534513088897164221935561009123017668371466147451255534832948177329641385715555229312770, 918501639812278091332144159251084155543856730849394470801468954305730461055546268192885488826644, 405472792036577094526460477547831074114291063971707319622012780348940908463521601281488544244169, 1175381733984537218967176618510422210277091340329772921924286553395846077598598834846082046866824, 731369715763911655594718732831110290558804850135369128827354321957988171986801623312962460163179, 450605273209796440253516212685324229109601618280452642619149182947683417342089913374674301607009, 969322844721295724323615859757117016268060526191836770424495073825603671163473159975975567820677, 1348261268843416613473603401242123998021247809996769674592248755545766062595042171020486271749032, 1466148577104074367688216688632674749426168363051452186158711857056869850436679527138754229885010, 70908463834529463135282588819511452498346514265036875270260431885528008093246967663346504967232, 838486862920988969113730671177195163773346851259995131437817227326889920499233913447275303192244, 93543989423033024183732418119594741017057867021583022735112518728380557429423860855744631494625, 1179728974153294007811309435772078708292845699744702173988514127958875244065266225647225746176936, 528807756882739122331333139713106167754663374584313236116759722675025783917186916029643233180299, 1213693836918391249389723853927487024099152164005317266746655479774063201171044828160766826588304, 651651788155420130788764187328425428424312255996291912530469791150829534619129032776534957948342, 941516385998054783626715179362149205447529616531222817131390565930095388070977837435989419573631, 986875910763012487166664929117273742533134501030680291686253090144074565612264523466336733746149, 685598957139308635139437164111801094927607829251974385527369150386727852672044509850035415556661, 665175781040596900356739124631387900482152247376689457829097493391537284481616905455659330433426, 293162912923312132291980754741339553894307396625491339361635861503100073490942486637523386180507, 1391014671944374379272751536954725462408109863205701550127603718456869591986287549574803394682897, 572694723677457763808609236007997674924405949702982384324530490739255278006710286128332201070674, 652746222441972294270891784765266708346615152893073273574156983014996598030745878819159427392861, 1309150194509139269928165389824692731310707190079118877878013622965661728467188283745316466581310, 660038042014703599318125056143653646149349547549128647938100502738740599992227644672716010929582, 740456689741248373934636625404132602306419956108073289015835207314020792763820882300981110558092, 201847534491891724513466481063365920640959896844711508045123238037730358806221101888841571483565, 1144308782917720492151527543179238361805578646177205621384752033357132438835185431408473914133618, 50694336006287506844873137082333265634702335792194228107366745581816568034883004711229481468898, 1296781833835703759475789979326503551104584212169964619783090737306432240386375127720897323026483, 742721217268050851891915428141747225792406028750061655995134901385317554516499588008717744569221]
enc = 90355149988439145980782570242195130871389518256201086989475564749197138598813757869612101828969471

def solve():
    a0, a1 = pub[0], pub[1]
    max_a = max(pub)
    
    # b0, b1 ë²”ìœ„ íƒìƒ‰ (Write-up ê¸°ì¤€)
    for b0 in range(1226, 2451):
        # b1ì˜ ë²”ìœ„ë¥¼ ì ì ˆíˆ ì„¤ì • (ì¼ë°˜ì ìœ¼ë¡œ b1 > b0)
        for b1 in range(b0 + 1, b0 + 2001):
            # L = |a0*b1 - a1*b0| ëŠ” qì˜ ë°°ìˆ˜ë‹¤!
            L = abs(a0 * b1 - a1 * b0)
            if L == 0: continue
            
            # K = L // q ì¸ë°, q > max(pub) ì´ë¯€ë¡œ K < L // max_a
            # KëŠ” ë³´í†µ b0, b1 ê·¼ì²˜ì˜ ì‘ì€ ê°’ì…ë‹ˆë‹¤.
            K_limit = (L // max_a) + 1
            
            # ì‹¤ì œ ë¬¸ì œì—ì„œëŠ” Kê°€ ë§¤ìš° ì‘ê²Œ í˜•ì„±ë©ë‹ˆë‹¤. (ì£¼ë¡œ 1~5000 ì‚¬ì´)
            for K in range(1, min(5000, int(K_limit))):
                if L % K == 0:
                    q = L // K
                    
                    # q í›„ë³´ê°€ í™•ë³´ë˜ë©´ rì„ ê³„ì‚°
                    # a0 = r * b0 (mod q) => r = a0 * inv(b0, q)
                    try:
                        inv_b0 = gmpy2.invert(b0, q)
                        r = (a0 * inv_b0) % q
                        r_inv = gmpy2.invert(r, q)
                        
                        # b ë°°ì—´ ë³µêµ¬ ë° ì´ˆì¦ê°€ì„± í™•ì¸
                        b_recovered = []
                        total = 0
                        possible = True
                        for ai in pub:
                            bi = (ai * r_inv) % q
                            if bi <= total:
                                possible = False
                                break
                            b_recovered.append(bi)
                            total += bi
                        
                        if possible:
                            # í”Œë˜ê·¸ ë³µêµ¬ (Greedy Knapsack)
                            target = (enc * r_inv) % q
                            bits = []
                            for bi in reversed(b_recovered):
                                if target >= bi:
                                    bits.append(1)
                                    target -= bi
                                else:
                                    bits.append(0)
                            
                            if target == 0:
                                M = sum(bit << i for i, bit in enumerate(reversed(bits)))
                                print(f"\n[!] ì„±ê³µ! q={q}, r={r}")
                                print(f"ğŸš© FLAG: {long_to_bytes(M).decode(errors='ignore')}")
                                return
                    except:
                        continue

if __name__ == "__main__":
    solve()